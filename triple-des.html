<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Triple DES (3DES) - Cryptography Toolkit</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            line-height: 1.6;
            color: #333;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            min-height: 100vh;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
        }

        .back-button {
            display: inline-block;
            background: rgba(255, 255, 255, 0.2);
            color: white;
            padding: 10px 20px;
            text-decoration: none;
            border-radius: 25px;
            margin-bottom: 20px;
            transition: all 0.3s ease;
        }

        .back-button:hover {
            background: rgba(255, 255, 255, 0.3);
            transform: translateY(-2px);
        }

        .algorithm-header {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            text-align: center;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .algorithm-header h1 {
            color: #4a5568;
            margin-bottom: 15px;
            font-size: 2.5rem;
        }

        .algorithm-header p {
            color: #666;
            font-size: 1.1rem;
            max-width: 600px;
            margin: 0 auto;
        }

        .working-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .working-section h2 {
            color: #4a5568;
            margin-bottom: 25px;
            font-size: 2rem;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            margin-bottom: 8px;
            color: #495057;
            font-weight: 600;
            font-size: 1.1rem;
        }

        .form-group input,
        .form-group textarea {
            width: 100%;
            padding: 15px;
            border: 2px solid #e9ecef;
            border-radius: 10px;
            font-size: 1rem;
            transition: border-color 0.3s ease;
        }

        .form-group input:focus,
        .form-group textarea:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 3px rgba(102, 126, 234, 0.1);
        }

        .form-group textarea {
            resize: vertical;
            min-height: 120px;
        }

        .checkbox-group {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .checkbox-group input[type="checkbox"] {
            width: auto;
            margin: 0;
        }

        .btn {
            background: linear-gradient(45deg, #667eea, #764ba2);
            color: white;
            padding: 15px 30px;
            border: none;
            border-radius: 10px;
            font-size: 1.1rem;
            font-weight: 600;
            cursor: pointer;
            transition: transform 0.3s ease, box-shadow 0.3s ease;
            box-shadow: 0 4px 12px rgba(0,0,0,0.15);
            margin-right: 15px;
            margin-bottom: 15px;
        }

        .btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 8px 20px rgba(0,0,0,0.2);
        }

        .btn-success {
            background: linear-gradient(45deg, #28a745, #20c997);
        }

        .btn-info {
            background: linear-gradient(45deg, #17a2b8, #6f42c1);
        }

        .btn-warning {
            background: linear-gradient(45deg, #ffc107, #fd7e14);
        }

        .result-box {
            background: #ffffff;
            border-radius: 15px;
            padding: 25px;
            margin-top: 25px;
            border-left: 5px solid #667eea;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }

        .result-box h4 {
            color: #495057;
            margin-bottom: 20px;
            font-size: 1.4rem;
        }

        .result-content p {
            margin-bottom: 15px;
            color: #6c757d;
            font-size: 1.1rem;
        }

        .result-content code {
            background: #f8f9fa;
            padding: 8px 12px;
            border-radius: 6px;
            font-family: 'Courier New', monospace;
            color: #e83e8c;
            word-break: break-all;
            font-size: 1rem;
        }

        .step-by-step {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin-top: 20px;
            border-left: 4px solid #28a745;
        }

        .step-by-step h5 {
            color: #495057;
            margin-bottom: 15px;
            font-size: 1.2rem;
        }

        .step-by-step ol {
            color: #6c757d;
            padding-left: 20px;
        }

        .step-by-step li {
            margin-bottom: 8px;
        }

        .theory-section {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 40px;
            margin-bottom: 30px;
            box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        }

        .theory-section h2 {
            color: #4a5568;
            margin-bottom: 25px;
            font-size: 2rem;
            border-bottom: 3px solid #667eea;
            padding-bottom: 10px;
        }

        .theory-section p {
            color: #666;
            margin-bottom: 15px;
            font-size: 1.1rem;
        }

        .formula-box {
            background: #2d3748;
            color: #e2e8f0;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            font-family: 'Courier New', monospace;
            font-size: 1.1rem;
            text-align: center;
        }

        .example-box {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border-left: 4px solid #667eea;
        }

        .example-box h4 {
            color: #495057;
            margin-bottom: 15px;
        }

        .example-box p {
            color: #6c757d;
            margin-bottom: 10px;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .algorithm-header, .working-section, .theory-section {
                padding: 25px;
            }
            
            .btn {
                width: 100%;
                margin-right: 0;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <a href="/" class="back-button">‚Üê Back to Toolkit</a>
        
        <div class="algorithm-header">
            <h1>üîê Triple DES (3DES)</h1>
            <p>Triple DES is a symmetric-key block cipher that applies the DES algorithm three times to each data block, providing enhanced security compared to single DES.</p>
        </div>

        <div class="theory-section">
            <h2>üìö Theory & How It Works</h2>
            <p>Triple DES (3DES) was developed to address the security weaknesses of the original DES algorithm. It applies DES encryption three times using either two or three different keys, significantly increasing the effective key length and security.</p>
            
            <div class="formula-box">
                <strong>Key Features:</strong><br>
                ‚Ä¢ Block size: 64 bits (8 bytes)<br>
                ‚Ä¢ Key size: 168 bits (21 bytes) for 3-key, 112 bits (14 bytes) for 2-key<br>
                ‚Ä¢ Rounds: 48 (3 √ó 16 DES rounds)<br>
                ‚Ä¢ Modes: EDE (Encrypt-Decrypt-Encrypt) or EEE (Encrypt-Encrypt-Encrypt)
            </div>

            <div class="example-box">
                <h4>3DES Process:</h4>
                <p><strong>3-Key 3DES:</strong> E(K‚ÇÅ) ‚Üí D(K‚ÇÇ) ‚Üí E(K‚ÇÉ)</p>
                <p><strong>2-Key 3DES:</strong> E(K‚ÇÅ) ‚Üí D(K‚ÇÇ) ‚Üí E(K‚ÇÅ)</p>
                <p><strong>Plaintext:</strong> 64-bit block</p>
                <p><strong>Process:</strong> First DES ‚Üí Second DES ‚Üí Third DES</p>
                <p><strong>Output:</strong> 64-bit encrypted block</p>
            </div>

            <p><strong>Security:</strong> 3DES provides approximately 112 bits of security (equivalent to 2-key 3DES) or 168 bits (3-key 3DES). While it was considered secure for many years, it has been deprecated in favor of AES due to its slower performance and the emergence of more efficient alternatives.</p>
        </div>

        <div class="working-section">
            <h2>üîß Working with Triple DES</h2>
            
            <form id="triple-des-form">
                <div class="form-group">
                    <label for="key1">First Key (8 characters):</label>
                    <input type="text" id="key1" value="FIRSTKEY" maxlength="8" placeholder="Enter first 8-character key" required>
                </div>
                
                <div class="form-group">
                    <label for="key2">Second Key (8 characters):</label>
                    <input type="text" id="key2" value="SECONDKY" maxlength="8" placeholder="Enter second 8-character key" required>
                </div>
                
                <div class="form-group">
                    <label for="key3">Third Key (8 characters):</label>
                    <input type="text" id="key3" value="THIRDKEY" maxlength="8" placeholder="Enter third 8-character key" required>
                </div>
                
                <div class="form-group">
                    <label for="plaintext">Plaintext (Text to Encrypt):</label>
                    <textarea id="plaintext" placeholder="Enter text to encrypt..." required></textarea>
                </div>
                
                <div class="checkbox-group">
                    <input type="checkbox" id="educational-mode">
                    <label for="educational-mode">Show Step-by-Step Process</label>
                </div>
                
                <button type="button" class="btn btn-success" onclick="encryptText()">üîê Encrypt</button>
                <button type="button" class="btn btn-info" onclick="decryptText()">üîì Decrypt</button>
                <button type="button" class="btn btn-warning" onclick="generateKeys()">üé≤ Generate Random Keys</button>
            </form>
            
            <div id="result"></div>
        </div>
    </div>

    <script>
        function generateRandomKeys() {
            const chars = 'ABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789';
            let key1 = '', key2 = '', key3 = '';
            
            for (let i = 0; i < 8; i++) {
                key1 += chars.charAt(Math.floor(Math.random() * chars.length));
                key2 += chars.charAt(Math.floor(Math.random() * chars.length));
                key3 += chars.charAt(Math.floor(Math.random() * chars.length));
            }
            
            document.getElementById('key1').value = key1;
            document.getElementById('key2').value = key2;
            document.getElementById('key3').value = key3;
            
            showResult(`
                <h4>üé≤ Random 3DES Keys Generated</h4>
                <div class="result-content">
                    <p>Three new random 64-bit DES keys have been generated for 3DES.</p>
                    <p><strong>Key 1:</strong> <code>${key1}</code></p>
                    <p><strong>Key 2:</strong> <code>${key2}</code></p>
                    <p><strong>Key 3:</strong> <code>${key3}</code></p>
                    <p><em>üí° These keys will be used for the 3DES encryption/decryption operations.</em></p>
                </div>
            `);
        }

        function encryptText() {
            const plaintext = document.getElementById('plaintext').value;
            const key1 = document.getElementById('key1').value;
            const key2 = document.getElementById('key2').value;
            const key3 = document.getElementById('key3').value;
            const educationalMode = document.getElementById('educational-mode').checked;
            
            if (!plaintext || !key1 || !key2 || !key3) {
                showResult('Please enter all three keys and text to encrypt');
                return;
            }
            
            if (key1.length !== 8 || key2.length !== 8 || key3.length !== 8) {
                showResult('All keys must be exactly 8 characters long');
                return;
            }
            
            // Simple 3DES simulation (for educational purposes)
            const encrypted = simulate3DESEncryption(plaintext, key1, key2, key3);
            
            let resultHTML = `
                <h4>üîê Triple DES Encryption Result</h4>
                <div class="result-content">
                    <p><strong>Plaintext:</strong> ${plaintext}</p>
                    <p><strong>Key 1:</strong> <code>${key1}</code></p>
                    <p><strong>Key 2:</strong> <code>${key2}</code></p>
                    <p><strong>Key 3:</strong> <code>${key3}</code></p>
                    <p><strong>Encrypted Data:</strong> <code>${encrypted}</code></p>
                </div>
            `;
            
            if (educationalMode) {
                resultHTML += `
                    <div class="step-by-step">
                        <h5>üìù 3DES Process (Simplified):</h5>
                        <ol>
                            <li>Convert plaintext to 64-bit blocks</li>
                            <li><strong>First DES:</strong> Encrypt with Key 1</li>
                            <li><strong>Second DES:</strong> Decrypt with Key 2</li>
                            <li><strong>Third DES:</strong> Encrypt with Key 3</li>
                            <li>Output final encrypted 64-bit block</li>
                        </ol>
                        <p><em>üí° This is a simplified demonstration. Real 3DES uses proper cryptographic operations.</em></p>
                    </div>
                `;
            }
            
            showResult(resultHTML);
        }
        
        function decryptText() {
            const ciphertext = document.getElementById('plaintext').value;
            const key1 = document.getElementById('key1').value;
            const key2 = document.getElementById('key2').value;
            const key3 = document.getElementById('key3').value;
            const educationalMode = document.getElementById('educational-mode').checked;
            
            if (!ciphertext || !key1 || !key2 || !key3) {
                showResult('Please enter all three keys and encrypted text to decrypt');
                return;
            }
            
            if (key1.length !== 8 || key2.length !== 8 || key3.length !== 8) {
                showResult('All keys must be exactly 8 characters long');
                return;
            }
            
            // Simple 3DES decryption simulation (for educational purposes)
            const decrypted = simulate3DESDecryption(ciphertext, key1, key2, key3);
            
            let resultHTML = `
                <h4>üîì Triple DES Decryption Result</h4>
                <div class="result-content">
                    <p><strong>Ciphertext:</strong> ${ciphertext}</p>
                    <p><strong>Key 1:</strong> <code>${key1}</code></p>
                    <p><strong>Key 2:</strong> <code>${key2}</code></p>
                    <p><strong>Key 3:</strong> <code>${key3}</code></p>
                    <p><strong>Decrypted Data:</strong> <code>${decrypted}</code></p>
                </div>
            `;
            
            if (educationalMode) {
                resultHTML += `
                    <div class="step-by-step">
                        <h5>üìù 3DES Decryption Process (Simplified):</h5>
                        <ol>
                            <li>Take encrypted 64-bit block</li>
                            <li><strong>First DES:</strong> Decrypt with Key 3</li>
                            <li><strong>Second DES:</strong> Encrypt with Key 2</li>
                            <li><strong>Third DES:</strong> Decrypt with Key 1</li>
                            <li>Output original plaintext</li>
                        </ol>
                        <p><em>üí° Decryption reverses the encryption process using the keys in reverse order.</em></p>
                    </div>
                `;
            }
            
            showResult(resultHTML);
        }
        
        function simulate3DESEncryption(plaintext, key1, key2, key3) {
            // This is a simplified simulation for educational purposes
            // Real 3DES would use proper cryptographic operations
            let result = '';
            
            for (let i = 0; i < plaintext.length; i++) {
                const charCode = plaintext.charCodeAt(i);
                const key1Char = key1.charCodeAt(i % key1.length);
                const key2Char = key2.charCodeAt(i % key2.length);
                const key3Char = key3.charCodeAt(i % key3.length);
                
                // Simulate 3DES: E(K1) -> D(K2) -> E(K3)
                let temp = (charCode + key1Char + 16) % 256;  // First DES
                temp = (temp - key2Char - 16 + 256) % 256;   // Second DES (decrypt)
                temp = (temp + key3Char + 16) % 256;         // Third DES
                
                result += String.fromCharCode(temp);
            }
            
            // Convert to base64 representation
            return btoa(result);
        }
        
        function simulate3DESDecryption(ciphertext, key1, key2, key3) {
            // This is a simplified simulation for educational purposes
            try {
                const decoded = atob(ciphertext);
                let result = '';
                
                for (let i = 0; i < decoded.length; i++) {
                    const charCode = decoded.charCodeAt(i);
                    const key1Char = key1.charCodeAt(i % key1.length);
                    const key2Char = key2.charCodeAt(i % key2.length);
                    const key3Char = key3.charCodeAt(i % key3.length);
                    
                    // Simulate 3DES decryption: D(K3) -> E(K2) -> D(K1)
                    let temp = (charCode - key3Char - 16 + 256) % 256;  // First DES (decrypt)
                    temp = (temp + key2Char + 16) % 256;                // Second DES
                    temp = (temp - key1Char - 16 + 256) % 256;         // Third DES (decrypt)
                    
                    result += String.fromCharCode(temp);
                }
                
                return result;
            } catch (e) {
                return "Error: Invalid encrypted data format";
            }
        }
        
        function showResult(content) {
            document.getElementById('result').innerHTML = `<div class="result-box">${content}</div>`;
        }
    </script>
</body>
</html>
